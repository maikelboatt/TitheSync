<!--
    ShellView.xaml
    This file defines the main shell view for the TitheSync application using XAML.
    It includes the layout and styling for the navigation menu, header, and content area.
    The view is designed to work with the MVVM pattern and integrates with MvvmCross for WPF.
-->

<views:MvxWpfView x:Class="TitheSync.UI.Views.ShellView"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:components="clr-namespace:TitheSync.UI.Components"
                  xmlns:customs="clr-namespace:TitheSync.UI.Customs"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:local="clr-namespace:TitheSync.UI.Views"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:members="clr-namespace:TitheSync.Core.ViewModels.Members;assembly=TitheSync.Core"
                  xmlns:modalDialogControl="clr-namespace:ModalDialogControl;assembly=ModalDialogControl"
                  xmlns:panes="clr-namespace:TitheSync.Core.ViewModels.Panes;assembly=TitheSync.Core"
                  xmlns:payments="clr-namespace:TitheSync.Core.ViewModels.Payments;assembly=TitheSync.Core"
                  xmlns:viewModels="clr-namespace:TitheSync.Core.ViewModels;assembly=TitheSync.Core"
                  xmlns:views="clr-namespace:MvvmCross.Platforms.Wpf.Views;assembly=MvvmCross.Platforms.Wpf"
                  Name="Root"
                  d:DataContext="{d:DesignInstance Type=viewModels:ShellViewModel}"
                  d:DesignHeight="600"
                  d:DesignWidth="1100"
                  FontFamily="Cinzel Decorative"
                  mc:Ignorable="d">

    <views:MvxWpfView.Resources>
        <DataTemplate DataType="{x:Type viewModels:HomeViewModel}">
            <local:HomeView />
        </DataTemplate>

        <DataTemplate DataType="{x:Type viewModels:DashboardViewModel}">
            <local:DashboardView />
        </DataTemplate>

        <DataTemplate DataType="{x:Type viewModels:PaymentViewModel}">
            <local:PaymentsView />
        </DataTemplate>

        <DataTemplate DataType="{x:Type viewModels:NotificationViewModel}">
            <local:NotificationView />
        </DataTemplate>

        <DataTemplate DataType="{x:Type viewModels:SettingsViewModel}">
            <local:SettingsView />
        </DataTemplate>

        <DataTemplate DataType="{x:Type members:MemberListingViewModel}">
            <components:MemberListing />
        </DataTemplate>

        <DataTemplate DataType="{x:Type payments:PaymentListingViewModel}">
            <components:PaymentListing />
        </DataTemplate>

        <DataTemplate DataType="{x:Type panes:NotificationPaneViewModel}">
            <components:NotificationPane />
        </DataTemplate>

        <DataTemplate DataType="{x:Type panes:ChartPaneViewModel}">
            <components:ChartPane />
        </DataTemplate>

        <DataTemplate DataType="{x:Type panes:SettingsPaneViewModel}">
            <components:SettingsPane />
        </DataTemplate>
    </views:MvxWpfView.Resources>

    <!--  Main container with rounded corners  -->
    <Border UseLayoutRounding="True">
        <Grid>
            <!--  Opacity mask for the grid  -->
            <Grid.OpacityMask>
                <VisualBrush Visual="{Binding ElementName=Border}" />
            </Grid.OpacityMask>

            <!--  Modal Dialog Control  -->
            <modalDialogControl:ModalDialog Panel.ZIndex="1"
                                            IsOpen="{Binding IsModalOpen, UpdateSourceTrigger=PropertyChanged}"
                                            TheBackground="{DynamicResource TertiaryBackgroundColor}"
                                            TheShadow="{DynamicResource SecondaryWhiteColor}">

                <ContentControl Margin="30,15" Content="{Binding CurrentModalContent}" />
            </modalDialogControl:ModalDialog>
            <!--  Main border with primary background color  -->
            <Border x:Name="Border"
                    Background="{DynamicResource PrimaryBackgroundColor}"
                    CornerRadius="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <!--  Navigation column  -->
                        <ColumnDefinition Width="Auto" />
                        <!--  Content column  -->
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!--  Navigation panel  -->
                    <Border Grid.Column="0"
                            Background="{DynamicResource SecondaryBackgroundColor}"
                            CornerRadius="10 0 0 10">

                        <Grid x:Name="GridNav" Width="60">
                            <Grid.RowDefinitions>
                                <!--  Header row  -->
                                <RowDefinition Height="60" />
                                <!--  Menu items row  -->
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!--  Application logo and title  -->
                            <Grid Grid.Row="0">
                                <Border Width="32"
                                        Height="24"
                                        Margin="14,0,0,0"
                                        HorizontalAlignment="Left">
                                    <Border.Background>
                                        <ImageBrush ImageSource="../Assets/Icons/logo.png" Stretch="Uniform" />
                                    </Border.Background>
                                </Border>

                                <Label Margin="60,0,0,0"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center"
                                       Content="TitheSync"
                                       FontFamily="Amita"
                                       FontSize="16"
                                       FontWeight="Bold"
                                       Foreground="{DynamicResource PrimaryTextColor}" />
                            </Grid>

                            <!--  Menu items  -->
                            <StackPanel Grid.Row="1" Margin="-1,20,0,20">
                                <!--  Dashboard button  -->
                                <Button x:Name="BtnDashboard"
                                        MouseEnter="btnDashboard_MouseEnter"
                                        MouseLeave="btnDashboard_MouseLeave"
                                        Style="{DynamicResource PopupButtonStyle}">
                                    <customs:NavigationItem VerticalAlignment="Center"
                                                            CommandName="{Binding NavigateToDashboardCommand}"
                                                            GroupName="MenuItem"
                                                            Icon="{DynamicResource Dashboard}"
                                                            IconWidth="16"
                                                            IndicatorBrush="{DynamicResource PrimaryBlueColor}"
                                                            Text="Dashboard" />
                                </Button>

                                <!--  Home button  -->
                                <Button x:Name="BtnHome"
                                        MouseEnter="btnHome_MouseEnter"
                                        MouseLeave="btnHome_MouseLeave"
                                        Style="{DynamicResource PopupButtonStyle}">
                                    <customs:NavigationItem VerticalAlignment="Center"
                                                            CommandName="{Binding NavigateToHomeCommand}"
                                                            GroupName="MenuItem"
                                                            Icon="{DynamicResource Home}"
                                                            IconWidth="16"
                                                            IndicatorBrush="{DynamicResource PrimaryBlueColor}"
                                                            Text="Home" />
                                </Button>

                                <!--  Billing button  -->
                                <Button x:Name="BtnBilling"
                                        MouseEnter="btnBilling_MouseEnter"
                                        MouseLeave="btnBilling_MouseLeave"
                                        Style="{DynamicResource PopupButtonStyle}">
                                    <customs:NavigationItem VerticalAlignment="Center"
                                                            CommandName="{Binding NavigateToPaymentCommand}"
                                                            GroupName="MenuItem"
                                                            Icon="{DynamicResource Payments}"
                                                            IconWidth="16"
                                                            IndicatorBrush="{DynamicResource PrimaryBlueColor}"
                                                            Text="Payments" />
                                </Button>

                                <!--  Notifications button  -->
                                <Button x:Name="BtnOrderList"
                                        MouseEnter="btnOrderList_MouseEnter"
                                        MouseLeave="btnOrderList_MouseLeave"
                                        Style="{DynamicResource PopupButtonStyle}">
                                    <customs:NavigationItem VerticalAlignment="Center"
                                                            CommandName="{Binding NavigateToNotificationCommand}"
                                                            GroupName="MenuItem"
                                                            Icon="{DynamicResource Notification}"
                                                            IconWidth="16"
                                                            IndicatorBrush="{DynamicResource PrimaryBlueColor}"
                                                            Text="Notifications" />
                                </Button>

                                <!--  Settings button  -->
                                <Button x:Name="BtnSetting"
                                        MouseEnter="btnSetting_MouseEnter"
                                        MouseLeave="btnSetting_MouseLeave"
                                        Style="{DynamicResource PopupButtonStyle}">
                                    <customs:NavigationItem VerticalAlignment="Center"
                                                            CommandName="{Binding NavigateToSettingsCommand}"
                                                            GroupName="MenuItem"
                                                            Icon="{DynamicResource Settings}"
                                                            IconWidth="16"
                                                            IndicatorBrush="{DynamicResource PrimaryBlueColor}"
                                                            Text="Setting" />
                                </Button>
                            </StackPanel>

                            <!--  Popup user control  -->
                            <Popup x:Name="Popup"
                                   AllowsTransparency="True"
                                   HorizontalOffset="0"
                                   VerticalOffset="10">
                                <customs:UserPopUp x:Name="Header" Foreground="{DynamicResource PrimaryTextColor}" />
                            </Popup>
                        </Grid>
                    </Border>

                    <!--  Main content area  -->
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <!--  Header row  -->
                            <RowDefinition Height="60" />
                            <!--  Content row  -->
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <!--  Toggle button for expanding/collapsing the navigation panel  -->
                        <ToggleButton x:Name="TgBtn"
                                      Margin="10,15,0,15"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Center"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      Style="{DynamicResource IToggleButtonStyle}">
                            <ToggleButton.Triggers>
                                <!--  Animation for collapsing the navigation panel  -->
                                <EventTrigger RoutedEvent="ToggleButton.Unchecked">
                                    <BeginStoryboard>
                                        <Storyboard x:Name="HideStackPanel">
                                            <DoubleAnimation BeginTime="0:0:0"
                                                             Storyboard.TargetName="GridNav"
                                                             Storyboard.TargetProperty="Width"
                                                             From="210"
                                                             To="60"
                                                             Duration="0:0:0.5" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <!--  Animation for expanding the navigation panel  -->
                                <EventTrigger RoutedEvent="ToggleButton.Checked">
                                    <BeginStoryboard>
                                        <Storyboard x:Name="ShowStackPanel">
                                            <DoubleAnimation BeginTime="0:0:0"
                                                             Storyboard.TargetName="GridNav"
                                                             Storyboard.TargetProperty="Width"
                                                             From="60"
                                                             To="210"
                                                             Duration="0:0:0.5" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </ToggleButton.Triggers>
                        </ToggleButton>

                        <!--  Window control buttons (Close, Restore, Minimize)  -->
                        <StackPanel Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Height="30"
                                    Margin="0,5,10,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    FlowDirection="RightToLeft"
                                    Orientation="Horizontal">
                            <!--  Close button  -->
                            <Button x:Name="BtnClose"
                                    Click="BtnClose_Click"
                                    Content="{DynamicResource Close}"
                                    Style="{StaticResource IconButtonsStyle}"
                                    Tag="IsCloseButton" />
                            <!--  Restore/Maximize button  -->
                            <Button x:Name="BtnRestore"
                                    Margin="5,0"
                                    Click="BtnRestore_Click">
                                <Button.Style>
                                    <Style BasedOn="{StaticResource IconButtonsStyle}" TargetType="{x:Type Button}">
                                        <Setter Property="Content" Value="{DynamicResource Maximize}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=home, Path=WindowState}" Value="Maximized">
                                                <Setter Property="Content" Value="{DynamicResource Restore}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <!--  Minimize button  -->
                            <Button x:Name="BtnMinimize"
                                    Click="BtnMinimize_Click"
                                    Content="{DynamicResource Minimize}"
                                    Style="{DynamicResource IconButtonsStyle}" />
                        </StackPanel>

                        <!--  Placeholder for dynamic content  -->
                        <ContentControl Grid.Row="1"
                                        Margin="20"
                                        Content="{Binding CurrentMainContent}" />
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Border>
</views:MvxWpfView>